#!/bin/sh

if [ ${#} -ne 1 ]; then
   printf "Usage: `basename ${0}` <CGAL-release-id>\n"
   printf "(e.g., `basename ${0}` CGAL-2.3-I-15)\n"
   exit 1
fi

CGAL_MANUAL_TEST_DIR="/KM/usr3/cgal/Manual"
MANUAL_TEST_LOG="${CGAL_MANUAL_TEST_DIR}/autotest_manual.log"
CGAL_RELEASE_ID="${1}"
CGAL_RELEASE_NUM=`echo ${CGAL_RELEASE_ID} | sed 's/CGAL-//'`

SENDMAIL=mail
DEVELOPERS=cgal-develop-l@postino.mpi-sb.mpg.de
MANUAL_TEST_URL="http://www.cgal.org/Members/Manual_test/${CGAL_RELEASE_ID}.manual_test.html"


cd $CGAL_MANUAL_TEST_DIR
install_manual_files $CGAL_RELEASE_NUM > $MANUAL_TEST_LOG 2>&1
cd CGAL-${CGAL_RELEASE_NUM}_doc_tex
make test >> $MANUAL_TEST_LOG 2>&1
make install_test >> $MANUAL_TEST_LOG 2>&1

#
# notify people that the test is done
#
printf "Subject: New manual test results ${CGAL_RELEASE_ID}\n\n\n${MANUAL_TEST_URL}\n" | ${SENDMAIL} ${DEVELOPERS} 
